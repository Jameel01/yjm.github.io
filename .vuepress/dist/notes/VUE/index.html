<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue 开发笔记 | 智宇星空</title>
    <meta name="description" content="前端学习资料">
    <link rel="icon" href="favicon.ico">
    
    <link rel="preload" href="/yjm.github.io/assets/css/0.styles.acbb5370.css" as="style"><link rel="preload" href="/yjm.github.io/assets/js/app.16d43aae.js" as="script"><link rel="preload" href="/yjm.github.io/assets/js/2.dc0e93a8.js" as="script"><link rel="preload" href="/yjm.github.io/assets/js/9.0c75ee61.js" as="script"><link rel="prefetch" href="/yjm.github.io/assets/js/10.beb399c5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/11.ca77d212.js"><link rel="prefetch" href="/yjm.github.io/assets/js/12.45689107.js"><link rel="prefetch" href="/yjm.github.io/assets/js/13.aa1b3fbe.js"><link rel="prefetch" href="/yjm.github.io/assets/js/14.8a0e7fde.js"><link rel="prefetch" href="/yjm.github.io/assets/js/15.3633e7a9.js"><link rel="prefetch" href="/yjm.github.io/assets/js/16.b3294066.js"><link rel="prefetch" href="/yjm.github.io/assets/js/17.dc0284b9.js"><link rel="prefetch" href="/yjm.github.io/assets/js/18.cbdb9d59.js"><link rel="prefetch" href="/yjm.github.io/assets/js/19.5251db80.js"><link rel="prefetch" href="/yjm.github.io/assets/js/20.12bad232.js"><link rel="prefetch" href="/yjm.github.io/assets/js/21.09047114.js"><link rel="prefetch" href="/yjm.github.io/assets/js/22.fb0bb1fc.js"><link rel="prefetch" href="/yjm.github.io/assets/js/23.befdb5d2.js"><link rel="prefetch" href="/yjm.github.io/assets/js/24.acbdd388.js"><link rel="prefetch" href="/yjm.github.io/assets/js/25.dd404484.js"><link rel="prefetch" href="/yjm.github.io/assets/js/26.bfe88547.js"><link rel="prefetch" href="/yjm.github.io/assets/js/27.b18b740d.js"><link rel="prefetch" href="/yjm.github.io/assets/js/28.4e88ab0e.js"><link rel="prefetch" href="/yjm.github.io/assets/js/29.e282f883.js"><link rel="prefetch" href="/yjm.github.io/assets/js/3.ba283e77.js"><link rel="prefetch" href="/yjm.github.io/assets/js/30.d6ff8809.js"><link rel="prefetch" href="/yjm.github.io/assets/js/31.2637266c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/32.557aaf69.js"><link rel="prefetch" href="/yjm.github.io/assets/js/33.88f4e582.js"><link rel="prefetch" href="/yjm.github.io/assets/js/34.dae3780d.js"><link rel="prefetch" href="/yjm.github.io/assets/js/35.6b9506b5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/36.858c4d62.js"><link rel="prefetch" href="/yjm.github.io/assets/js/37.f8d863af.js"><link rel="prefetch" href="/yjm.github.io/assets/js/38.a6cd0274.js"><link rel="prefetch" href="/yjm.github.io/assets/js/39.ddf074bc.js"><link rel="prefetch" href="/yjm.github.io/assets/js/4.5942c30c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/40.04216fe1.js"><link rel="prefetch" href="/yjm.github.io/assets/js/41.8ef5b19c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/42.99d6c4a5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/43.6af8c75b.js"><link rel="prefetch" href="/yjm.github.io/assets/js/5.4c6ec876.js"><link rel="prefetch" href="/yjm.github.io/assets/js/6.82ba9ee8.js"><link rel="prefetch" href="/yjm.github.io/assets/js/7.d5846097.js"><link rel="prefetch" href="/yjm.github.io/assets/js/8.21d2d8cf.js">
    <link rel="stylesheet" href="/yjm.github.io/assets/css/0.styles.acbb5370.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yjm.github.io/" class="home-link router-link-active"><!----> <span class="site-name">智宇星空</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yjm.github.io/notes/VUE/" class="nav-link router-link-exact-active router-link-active">前端笔记</a></div><div class="nav-item"><a href="/yjm.github.io/doc/" class="nav-link">资源导航</a></div><div class="nav-item"><a href="https://github.com/Jameel01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/yjm.github.io/notes/VUE/" class="nav-link router-link-exact-active router-link-active">前端笔记</a></div><div class="nav-item"><a href="/yjm.github.io/doc/" class="nav-link">资源导航</a></div><div class="nav-item"><a href="https://github.com/Jameel01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/VUE/" class="active sidebar-link">vue 开发笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#事件处理" class="sidebar-link">事件处理</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#vue-data恢复初始化" class="sidebar-link">vue data恢复初始化</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#provide-inject-组件通信依赖注入" class="sidebar-link">provide/inject 组件通信依赖注入</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#axios-监听上传进度" class="sidebar-link">axios 监听上传进度</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#vue-组件属性双向绑定" class="sidebar-link">vue 组件属性双向绑定</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#深入响应式原理" class="sidebar-link">深入响应式原理</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#vue-cli-环境变量和模式" class="sidebar-link">VUE-CLI 环境变量和模式</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#渲染优化-v-cloak" class="sidebar-link">渲染优化 v-cloak</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#render-函数使用场景" class="sidebar-link">render 函数使用场景</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#过滤url中不需要的参数" class="sidebar-link">过滤url中不需要的参数</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#修改微信标题" class="sidebar-link">修改微信标题</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#手机号码格式校验" class="sidebar-link">手机号码格式校验</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#npm包安装问题" class="sidebar-link">npm包安装问题</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#微信sdk使用" class="sidebar-link">微信SDK使用</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#重载页面" class="sidebar-link">重载页面</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#遮罩层限制背景滚动" class="sidebar-link">遮罩层限制背景滚动</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#监听storage事件" class="sidebar-link">监听storage事件</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#历史管理" class="sidebar-link">历史管理</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#visibilitychange-事件；用于判断用户是否离开当前页面" class="sidebar-link">VisibilityChange 事件；用于判断用户是否离开当前页面</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#时间转换" class="sidebar-link">时间转换</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#判断空对象" class="sidebar-link">判断空对象</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#函数式组件" class="sidebar-link">函数式组件</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#递归组件" class="sidebar-link">递归组件</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#其他" class="sidebar-link">其他</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/VUE/#echart-按需引入" class="sidebar-link">echart 按需引入</a></li></ul></li><li><a href="/yjm.github.io/notes/VUE/optimize.html" class="sidebar-link">性能优化</a></li><li><a href="/yjm.github.io/notes/VUE/vuecli.html" class="sidebar-link">Vue-CLI</a></li><li><a href="/yjm.github.io/notes/VUE/VUEX/" class="sidebar-link">vuex</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/REACT/" class="sidebar-link">React 开发笔记</a></li><li><a href="/yjm.github.io/notes/REACT/render.html" class="sidebar-link">React 渲染</a></li><li><a href="/yjm.github.io/notes/REACT/ReactApi.html" class="sidebar-link">React api</a></li><li><a href="/yjm.github.io/notes/REACT/Redux.html" class="sidebar-link">Redux</a></li><li><a href="/yjm.github.io/notes/REACT/Taro.html" class="sidebar-link">taro组件构子</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/JS/" class="sidebar-link">JS笔记</a></li><li><a href="/yjm.github.io/notes/JS/JavaScript-1.html" class="sidebar-link">JavaScript原理</a></li><li><a href="/yjm.github.io/notes/JS/es6.html" class="sidebar-link">ES6 语法</a></li><li><a href="/yjm.github.io/notes/JS/es5.html" class="sidebar-link">ES5</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 常用语法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/typescript/type.html" class="sidebar-link">基础类型</a></li><li><a href="/yjm.github.io/notes/typescript/declare.html" class="sidebar-link">变量声明</a></li><li><a href="/yjm.github.io/notes/typescript/interface.html" class="sidebar-link">接口</a></li><li><a href="/yjm.github.io/notes/typescript/class.html" class="sidebar-link">类</a></li><li><a href="/yjm.github.io/notes/typescript/function.html" class="sidebar-link">函数</a></li><li><a href="/yjm.github.io/notes/typescript/generic.html" class="sidebar-link">泛型</a></li><li><a href="/yjm.github.io/notes/typescript/inference.html" class="sidebar-link">类型推断</a></li><li><a href="/yjm.github.io/notes/typescript/advance.html" class="sidebar-link">高级类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DOM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/DOM/" class="sidebar-link">DOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/CSS/" class="sidebar-link">CSS开发笔记</a></li><li><a href="/yjm.github.io/notes/CSS/shapes/" class="sidebar-link">/notes/CSS/shapes/</a></li><li><a href="/yjm.github.io/notes/CSS/sass.html" class="sidebar-link">Dart-Sass</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/WEBPACK/" class="sidebar-link">webpack 性能优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>IOS问题库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/IOS/" class="sidebar-link">ios 问题库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/window/" class="sidebar-link">Event Loop</a></li><li><a href="/yjm.github.io/notes/window/HTTP/" class="sidebar-link">HTTP协议</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>RegExp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/REGEXP/" class="sidebar-link">正则表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/GIT/" class="sidebar-link">git 三种工作流程</a></li><li><a href="/yjm.github.io/notes/GIT/gitflow.html" class="sidebar-link">git-flow 的工作流程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/OTHER/" class="sidebar-link">其他</a></li><li><a href="/yjm.github.io/notes/OTHER/NPM.html" class="sidebar-link">verdaccio 私有npm仓库搭建</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-开发笔记"><a href="#vue-开发笔记" aria-hidden="true" class="header-anchor">#</a> vue 开发笔记</h1> <h2 id="事件处理"><a href="#事件处理" aria-hidden="true" class="header-anchor">#</a> 事件处理</h2> <p><a href="https://cn.vuejs.org/v2/guide/events.html" target="_blank" rel="noopener noreferrer">开发文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="事件修饰符"><a href="#事件修饰符" aria-hidden="true" class="header-anchor">#</a> 事件修饰符</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 阻止单击事件继续传播 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.stop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doThis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 提交事件不再重载页面 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name"><span class="token namespace">v-on:</span>submit.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onSubmit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 修饰符可以串联 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.stop.prevent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doThat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 只有修饰符 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name"><span class="token namespace">v-on:</span>submit.prevent</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 添加事件监听器时使用事件捕获模式 --&gt;</span>
<span class="token comment">&lt;!-- 即元素自身触发的事件先在此处理，然后才交由内部元素进行处理 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.capture</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doThis<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 只当在 event.target 是当前元素自身时触发处理函数 --&gt;</span>
<span class="token comment">&lt;!-- 即事件不是从内部元素触发的 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click.self</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doThat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>使用修饰符时，顺序很重要；相应的代码会以同样的顺序产生。因此，用 v-on:click.prevent.self 会阻止所有的点击，而 v-on:click.self.prevent 只会阻止对元素自身的点击。</p></div> <p>访问原始的 DOM 事件。可以用特殊变量 $event 把它传入方法：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>warn('Form cannot be submitted yet.', $event)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  Submit
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">warn</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 现在我们可以访问原生事件对象</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="按键修饰符"><a href="#按键修饰符" aria-hidden="true" class="header-anchor">#</a> 按键修饰符</h4> <p>全部的按键别名：</p> <ul><li><code>.enter</code></li> <li><code>.tab</code></li> <li><code>.delete</code> (捕获“删除”和“退格”键)</li> <li><code>.esc</code></li> <li><code>.space</code></li> <li><code>.up</code></li> <li><code>.down</code></li> <li><code>.left</code></li> <li><code>.right</code></li></ul> <h4>自动匹配按键修饰符</h4> <p>你也可直接将 <a href="https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values" target="_blank" rel="noopener"><code>KeyboardEvent.key</code></a> 暴露的任意有效按键名转换为 kebab-case 来作为修饰符：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">@keyup.page-down</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>onPageDown<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>有一些按键 (.esc 以及所有的方向键) 在 IE9 中有不同的 key 值, 如果你想支持 IE9，它们的内置别名应该是首选。</p></div> <h2 id="vue-data恢复初始化"><a href="#vue-data恢复初始化" aria-hidden="true" class="header-anchor">#</a> vue data恢复初始化</h2> <div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="provide-inject-组件通信依赖注入"><a href="#provide-inject-组件通信依赖注入" aria-hidden="true" class="header-anchor">#</a> provide/inject 组件通信依赖注入</h2> <p><a href="https://cn.vuejs.org/v2/api/#provide-inject" target="_blank" rel="noopener noreferrer">provide / inject API<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>主要解决了跨级组件间的通信问题，不过它的使用场景，主要是子组件获取上级组件的状态，跨级组件间建立了一种主动提供与依赖注入的关系。然后有两种场景它不能很好的解决（通过 <code>$on/$emit</code> 解决）：</p> <ul><li>父组件向子组件（支持跨级）传递数据</li> <li>子组件向父组件（支持跨级）传递数据</li></ul> <h3 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// A.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  provide<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'demo'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// B.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  inject<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// demo</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="小项目中代替vuex-减少依赖"><a href="#小项目中代替vuex-减少依赖" aria-hidden="true" class="header-anchor">#</a> 小项目中代替vuex,减少依赖</h3> <p>app.vue</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> mixins_user <span class="token keyword">from</span> <span class="token string">'../mixins/user.js'</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span>mixins_user<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function">provide</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">:</span> <span class="token keyword">this</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>

      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>user.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      userInfo<span class="token punctuation">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">getUserInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 这里通过 ajax 获取用户信息后，赋值给 this.userInfo，以下为伪代码</span>
      $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/user/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> data<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>引用页面</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    {{ app.userInfo }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    inject<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'app'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token function">changeUserInfo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 这里修改完用户数据后，通知 app.vue 更新，以下为伪代码</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/user/update'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// 直接通过 this.app 就可以调用 app.vue 里的方法</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="tip custom-block"><p>使用 Vuex，最主要的目的是跨组件通信、全局数据维护、多人协同开发。需求比如有：用户的登录信息维护、通知信息维护等全局的状态和数据。</p></div> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>provide 和 inject 绑定并<code>不是可响应的</code>。这是刻意为之的。然而，如果你传入了一个可监听的对象，那么其对象的属性还是可响应的。</p></div> <h2 id="axios-监听上传进度"><a href="#axios-监听上传进度" aria-hidden="true" class="header-anchor">#</a> axios 监听上传进度</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">static</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> params<span class="token punctuation">,</span> config<span class="token punctuation">,</span> onUploadCallback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      axios
        <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> qs<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token operator">...</span>config<span class="token punctuation">,</span>
          <span class="token function-variable function">onUploadProgress</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">progressEvent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>progressEvent<span class="token punctuation">.</span>lengthComputable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">//属性lengthComputable主要表明总共需要完成的工作量和已经完成的工作是否可以被测量</span>
              <span class="token comment">//如果lengthComputable为false，就获取不到progressEvent.total和progressEvent.loaded</span>
              <span class="token comment">// callback1(progressEvent);</span>
              onUploadCallback <span class="token operator">&amp;&amp;</span> <span class="token function">onUploadCallback</span><span class="token punctuation">(</span>progressEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">resolve</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="vue-组件属性双向绑定"><a href="#vue-组件属性双向绑定" aria-hidden="true" class="header-anchor">#</a> vue 组件属性双向绑定</h2> <ol><li>自定义v-model</li></ol> <p>允许一个自定义组件在使用 v-model 时定制 prop 和 event。默认情况下，一个组件上的 v-model 会把 value 用作 prop 且把 input 用作 event，但是一些输入类型比如单选框和复选框按钮可能想使用 value prop 来达到不同的目的。使用 model 选项可以回避这些情况产生的冲突。</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'my-checkbox'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  model<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    prop<span class="token punctuation">:</span> <span class="token string">'checked'</span><span class="token punctuation">,</span>
    event<span class="token punctuation">:</span> <span class="token string">'change'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// this allows using the `value` prop for a different purpose</span>
    value<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    <span class="token comment">// use `checked` as the prop which take the place of `value`</span>
    checked<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-checkbox</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>some value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-checkbox</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上述代码相当于：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-checkbox</span>
  <span class="token attr-name">:checked</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>foo<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>val =&gt; { foo = val }<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>some value<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-checkbox</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>自定义事件修饰符.async
在有些情况下，我们可能需要对一个 prop 进行“双向绑定”。不幸的是，真正的双向绑定会带来维护上的问题，因为子组件可以修改父组件，且在父组件和子组件都没有明显的改动来源。</li></ol> <p>这也是为什么我们推荐以 <code>update:myPropName</code> 的模式触发事件取而代之。举个例子，在一个包含 title prop 的假设的组件中，我们可以用以下方法表达对其赋新值的意图：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'update:title'</span><span class="token punctuation">,</span> newTitle<span class="token punctuation">)</span>
</code></pre></div><p>然后父组件可以监听那个事件并根据需要更新一个本地的数据属性。例如：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text-document</span>
  <span class="token attr-name"><span class="token namespace">v-bind:</span>title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doc.title<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name"><span class="token namespace">v-on:</span><span class="token namespace">update:</span>title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doc.title = $event<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text-document</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>为了方便起见，我们为这种模式提供一个缩写，即 .sync 修饰符：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text-document</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>title.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doc.title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text-document</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意</p> <p>注意带有 <code>.sync</code> 修饰符的 <code>v-bind</code> <code>不能</code>和表达式一起使用 (例如 <code>v-bind:title.sync=”doc.title + ‘!’”</code> 是无效的)。取而代之的是，你只能提供你想要绑定的属性名，类似 <code>v-model</code>。</p></div> <p>当我们用一个对象同时设置多个 prop 的时候，也可以将这个 .sync 修饰符和 v-bind 配合使用：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text-document</span> <span class="token attr-name">v-bind.sync</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>doc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text-document</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这样会把 doc 对象中的每一个属性 (如 title) 都作为一个独立的 prop 传进去，然后各自添加用于更新的 v-on 监听器。</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>将 <code>v-bind.sync</code> 用在一个字面量的对象上，例如 <code>v-bind.sync=”{ title: doc.title }”</code>，是无法正常工作的，因为在解析一个像这样的复杂表达式的时候，有很多边缘情况需要考虑。</p></div> <h2 id="深入响应式原理"><a href="#深入响应式原理" aria-hidden="true" class="header-anchor">#</a> 深入响应式原理</h2> <h3 id="追踪变化（响应监听）"><a href="#追踪变化（响应监听）" aria-hidden="true" class="header-anchor">#</a> 追踪变化（响应监听）</h3> <p>当你把一个普通的 JavaScript 对象传入 Vue 实例作为 data 选项，Vue 将遍历此对象所有的属性，并使用 <code>Object.defineProperty</code> 把这些属性全部转为 <code>getter/setter</code>。<br>
Object.defineProperty是es5无法shim的特性，所以vue不支持IE8及以下设备。<br>
每个组件实例都对应一个 watcher 实例，它会在组件渲染的过程中把“接触”过的数据属性记录为依赖。之后当依赖项的 setter 触发时，会通知 watcher，从而使它关联的组件重新渲染。</p> <p><img src="/yjm.github.io/assets/img/img-vue-0.5de7af21.png" alt="响应式"></p> <h3 id="检测变化的注意事项"><a href="#检测变化的注意事项" aria-hidden="true" class="header-anchor">#</a> 检测变化的注意事项</h3> <ul><li>受js限制，vue<strong>无法检测到对象属性的添加或删除</strong>。</li> <li>由于 Vue 会在初始化实例时对属性执行 getter/setter 转化，所以属性必须在 <code>data</code> 对象上存在才能让 Vue 将它转换为响应式的</li> <li>Vue 不允许动态添加根级别的响应式属性</li> <li>可以使用 Vue.set(object, key, value) 方法向嵌套对象添加响应式属性</li> <li>为已有对象赋值多个新属性</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 代替 `Object.assign(this.someObject, { a: 1, b: 2 })`</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>someObject <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>someObject<span class="token punctuation">,</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="声明响应式属性"><a href="#声明响应式属性" aria-hidden="true" class="header-anchor">#</a> 声明响应式属性</h3> <p>由于 Vue 不允许动态添加根级响应式属性，所以你必须在初始化实例前声明所有根级响应式属性，哪怕只是一个空值。
这样的限制在背后是有其技术原因的，它消除了在依赖项跟踪系统中的一类边界情况，也使 Vue 实例能更好地配合类型检查系统工作。</p> <h3 id="异步更新队列"><a href="#异步更新队列" aria-hidden="true" class="header-anchor">#</a> 异步更新队列</h3> <p>Vue 在更新 DOM 时是<strong>异步</strong>执行的,只要侦听到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据变更。如果同一个 <code>watcher</code> 被多次触发，只会被推入到队列中一次。这种在缓冲时去除重复数据对于避免不必要的计算和 DOM 操作是非常重要的</p> <p>为了在数据变化之后等待 Vue 完成更新 DOM，可以在数据变化之后立即使用 <code>Vue.nextTick(callback)</code>。</p> <p>在组件内使用 <code>vm.$nextTick()</code> 实例方法特别方便，因为它不需要全局 Vue，并且回调函数中的 this 将自动绑定到当前的 Vue 实例上：</p> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">updateMessage</span><span class="token punctuation">:</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">'已更新'</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '未更新'</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span> <span class="token comment">// =&gt; '已更新'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue-cli-环境变量和模式"><a href="#vue-cli-环境变量和模式" aria-hidden="true" class="header-anchor">#</a> VUE-CLI 环境变量和模式</h2> <p><a href="https://cli.vuejs.org/zh/guide/mode-and-env.html#%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer">文档说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>你可以替换你的项目根目录中的下列文件来指定环境变量：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>.env                <span class="token comment"># 在所有的环境中被载入</span>
.env.local          <span class="token comment"># 在所有的环境中被载入，但会被 git 忽略</span>
.env.<span class="token punctuation">[</span>mode<span class="token punctuation">]</span>         <span class="token comment"># 只在指定的模式中被载入</span>
.env.<span class="token punctuation">[</span>mode<span class="token punctuation">]</span>.local   <span class="token comment"># 只在指定的模式中被载入，但会被 git 忽略</span>
</code></pre></div><p>一个环境文件只包含环境变量的“键=值”对：</p> <div class="language- extra-class"><pre class="language-text"><code>FOO=bar
VUE_APP_SECRET=secret
</code></pre></div><p>被载入的变量将会对 vue-cli-service 的所有命令、插件和依赖可用。</p> <div class="tip custom-block"><p class="custom-block-title">环境加载属性</p> <p>为一个特定模式准备的环境文件的 (例如 <code>.env.production</code>) 将会比一般的环境文件 (例如 <code>.env</code>) 拥有更高的优先级。
此外，Vue CLI 启动时已经存在的环境变量拥有最高优先级，并不会被 .env 文件覆写。</p></div> <div class="warning custom-block"><p class="custom-block-title">NODE_ENV</p> <p>如果在环境中有默认的 <code>NODE_ENV</code>，你应该移除它或在运行 <code>vue-cli-service</code> 命令的时候明确地设置 NODE_ENV。</p></div> <h3 id="模式"><a href="#模式" aria-hidden="true" class="header-anchor">#</a> 模式</h3> <p><strong>模式</strong>是 Vue CLI 项目中一个重要的概念。默认情况下，一个 Vue CLI 项目有三个模式：</p> <ul><li><code>development</code> 模式用于 <code>vue-cli-service serve</code></li> <li><code>production</code> 模式用于 <code>vue-cli-service build</code> 和 <code>vue-cli-service test:e2e</code></li> <li><code>test</code> 模式用于 <code>vue-cli-service test:unit</code></li></ul> <p>注意模式不同于 <code>NODE_ENV</code>，一个模式可以包含多个环境变量。也就是说，每个模式都会将 <code>NODE_ENV</code> 的值设置为模式的名称——比如在 <code>development</code> 模式下 <code>NODE_ENV</code> 的值会被设置为 <code>&quot;development&quot;</code>。</p> <p>你可以通过为 <code>.env</code> 文件增加后缀来设置某个模式下特有的环境变量。比如，如果你在项目根目录创建一个名为 <code>.env.development</code> 的文件，那么在这个文件里声明过的变量就只会在 development 模式下被载入。</p> <p>你可以通过传递 <code>--mode</code> 选项参数为命令行覆写默认的模式。例如，如果你想要在构建命令中使用开发环境变量，请在你的 <code>package.json</code> 脚本中加入：</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;dev-build&quot;: &quot;vue-cli-service build --mode development&quot;,
</code></pre></div><h2 id="渲染优化-v-cloak"><a href="#渲染优化-v-cloak" aria-hidden="true" class="header-anchor">#</a> 渲染优化 v-cloak</h2> <p>这个指令保持在元素上直到关联实例结束编译。和 CSS 规则如 <code>[v-cloak] { display: none }</code> 一起用时，这个指令可以隐藏未编译的 Mustache 标签直到实例准备完毕。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">[v-cloak]</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-cloak</span><span class="token punctuation">&gt;</span></span>
  {{ message }}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="render-函数使用场景"><a href="#render-函数使用场景" aria-hidden="true" class="header-anchor">#</a> render 函数使用场景</h2> <p>1.使用两个相同 slot。在 template 中，Vue.js 不允许使用两个相同的 slot，比如下面的示例是错误的：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>解决方案是使用一个深度克隆 VNode 节点的方法<br>
2.在 SSR 环境（服务端渲染），如果不是常规的 template 写法，比如通过 Vue.extend 和 new Vue 构造来生成的组件实例，是编译不过的<br>
3.在 runtime 版本的 Vue.js 中，如果使用 Vue.extend 手动构造一个实例，使用 template 选项是会报错的<br>
4.一个 Vue.js 组件，有一部分内容需要从父级传递来显示，如果是文本之类的，直接通过 props 就可以，如果这个内容带有样式或复杂一点的 html 结构，可以使用 v-html 指令来渲染，父级传递的仍然是一个 HTML Element 字符串，不过它仅仅是能解析正常的 html 节点且有 XSS 风险。当需要最大化程度自定义显示内容时，就需要 Render 函数，它可以渲染一个完整的 Vue.js 组件。你可能会说，用 slot 不就好了？的确，slot 的作用就是做内容分发的，但在一些特殊组件中，可能 slot 也不行。比如一个表格组件</p> <h2 id="过滤url中不需要的参数"><a href="#过滤url中不需要的参数" aria-hidden="true" class="header-anchor">#</a> 过滤url中不需要的参数</h2> <div class="language-js extra-class"><pre class="language-js"><code>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/([?&amp;])(code|clear)=\w+/gi</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="修改微信标题"><a href="#修改微信标题" aria-hidden="true" class="header-anchor">#</a> 修改微信标题</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
  <span class="token keyword">var</span> mobile <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/iphone|ipad|ipod/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>mobile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;iframe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// iframe.style.visibility = &quot;hidden&quot;;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="手机号码格式校验"><a href="#手机号码格式校验" aria-hidden="true" class="header-anchor">#</a> 手机号码格式校验</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mobileRex <span class="token operator">=</span> <span class="token regex">/^(13[0-9]|14[579]|15[0-3,5-9]|16[67]|17[0135678]|18[0-9]|19[891])\d{8}$/</span><span class="token punctuation">;</span> 
</code></pre></div><h2 id="npm包安装问题"><a href="#npm包安装问题" aria-hidden="true" class="header-anchor">#</a> npm包安装问题</h2> <p>可能原因：
1.缓存<br>
2.加载不全<br>
3.版本变更依赖改变</p> <p>解决方案（逐个检验）：<br>
1.npm cache clear --force<br>
2.如果cnpm安装失败，可能原因是相关局部npm包更新，cnpm没有全部更新，导致关系错乱。采用npm安装<br>
3.重启电脑，采用npm安装</p> <h2 id="微信sdk使用"><a href="#微信sdk使用" aria-hidden="true" class="header-anchor">#</a> 微信SDK使用</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> wx <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;weixin-js-sdk&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">URL_HREF_WX_SERVER</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../assets/config/baseUrl&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Toast <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vant&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Api <span class="token keyword">from</span> <span class="token string">&quot;../api/api&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 微信SDK签名配置</span>
<span class="token keyword">function</span> <span class="token function">signature</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> debug <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> appId<span class="token punctuation">,</span> timestamp<span class="token punctuation">,</span> nonceStr<span class="token punctuation">,</span> signature <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    debug<span class="token punctuation">,</span> <span class="token comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。</span>
    appId<span class="token punctuation">,</span> <span class="token comment">// 必填，公众号的唯一标识</span>
    timestamp<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的时间戳</span>
    nonceStr<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的随机串</span>
    signature<span class="token punctuation">,</span> <span class="token comment">// 必填，签名</span>
    jsApiList<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;onMenuShareAppMessage&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;onMenuShareTimeline&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;onMenuShareQQ&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;onMenuShareWeibo&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;onMenuShareQZone&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;chooseWXPay&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;updateAppMessageShareData&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;updateTimelineShareData&quot;</span>
    <span class="token punctuation">]</span> <span class="token comment">// 必填，需要使用的JS接口列表</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 签名配置</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">wechatConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    axios
      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">URL_HREF_WX_SERVER</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> data<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">&quot;200&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          data <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
          <span class="token function">signature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            debug<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            appId<span class="token punctuation">:</span> data<span class="token punctuation">.</span>appId<span class="token punctuation">,</span>
            timestamp<span class="token punctuation">:</span> data<span class="token punctuation">.</span>timestamp<span class="token punctuation">,</span>
            nonceStr<span class="token punctuation">:</span> data<span class="token punctuation">.</span>nonceStr<span class="token punctuation">,</span>
            signature<span class="token punctuation">:</span> data<span class="token punctuation">.</span>signature
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          wx<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          wx<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Toast</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 微信信分享
 * @param {String} title 标题
 * @param {String} link 跳转链接
 * @param {String} imgUrl 图标地址
 * @param {String} desc 描述信息
 * @param {String} success 分享成功回调函数
 * @param {String} fail 分享失败回调函数
 * @param {String} cancel 分享取消回调函数
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">wxShare</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> link<span class="token punctuation">,</span> imgUrl<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> success<span class="token punctuation">,</span> fail<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wx<span class="token punctuation">.</span><span class="token function">onMenuShareTimeline</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
    desc<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
    imgUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
    success<span class="token punctuation">,</span>
    fail<span class="token punctuation">,</span>
    cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">onMenuShareAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
    desc<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
    imgUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
    success<span class="token punctuation">,</span>
    fail<span class="token punctuation">,</span>
    cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">onMenuShareQQ</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
    desc<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
    imgUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
    success<span class="token punctuation">,</span>
    fail<span class="token punctuation">,</span>
    cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">onMenuShareWeibo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
    desc<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
    imgUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
    success<span class="token punctuation">,</span>
    fail<span class="token punctuation">,</span>
    cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wx<span class="token punctuation">.</span><span class="token function">onMenuShareQZone</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
    desc<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
    imgUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
    success<span class="token punctuation">,</span>
    fail<span class="token punctuation">,</span>
    cancel
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 分享参数配置
 */</span>
<span class="token keyword">function</span> <span class="token function">shareConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> shareId <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    shareId<span class="token punctuation">,</span>
    imgUrl<span class="token punctuation">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    desc<span class="token punctuation">:</span> <span class="token string">&quot;描述文字&quot;</span><span class="token punctuation">,</span>
    title<span class="token punctuation">:</span> document<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
    link<span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>origin <span class="token operator">+</span> location<span class="token punctuation">.</span>pathname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?shareCode=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>shareId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      onMenuShareTimeline<span class="token punctuation">:</span> <span class="token string">&quot;分享朋友圈&quot;</span><span class="token punctuation">,</span>
      onMenuShareAppMessage<span class="token punctuation">:</span> <span class="token string">&quot;分享好友&quot;</span><span class="token punctuation">,</span>
      onMenuShareQQ<span class="token punctuation">:</span> <span class="token string">&quot;分享QQ&quot;</span><span class="token punctuation">,</span>
      onMenuShareWeibo<span class="token punctuation">:</span> <span class="token string">&quot;分享微博&quot;</span><span class="token punctuation">,</span>
      onMenuShareQZone<span class="token punctuation">:</span> <span class="token string">&quot;分享QQ空间&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * 分享统计
 * @param {String} mode 分享方式
 * @param {String} shareId 分享id
 */</span>
<span class="token keyword">function</span> <span class="token function">shareStatistics</span><span class="token punctuation">(</span><span class="token parameter">mode<span class="token punctuation">,</span> shareId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Api<span class="token punctuation">.</span><span class="token function">share</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    shareTime<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    shareId<span class="token punctuation">,</span>
    mode<span class="token punctuation">,</span>
    productId<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">wechatConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token function">shareConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">wxShare</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> params<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
      link<span class="token punctuation">:</span> params<span class="token punctuation">.</span>link<span class="token punctuation">,</span>
      imgUrl<span class="token punctuation">:</span> params<span class="token punctuation">.</span>imgUrl<span class="token punctuation">,</span>
      desc<span class="token punctuation">:</span> params<span class="token punctuation">.</span>desc<span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">shareStatistics</span><span class="token punctuation">(</span>
          params<span class="token punctuation">.</span>alias<span class="token punctuation">[</span>val<span class="token punctuation">.</span>errMsg<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>link<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;?shareCode=&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="重载页面"><a href="#重载页面" aria-hidden="true" class="header-anchor">#</a> 重载页面</h2> <div class="language-js extra-class"><pre class="language-js"><code>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span>isfouce<span class="token punctuation">)</span><span class="token comment">//true强制刷新获取新数据，false会取缓存中的值</span>
</code></pre></div><h2 id="遮罩层限制背景滚动"><a href="#遮罩层限制背景滚动" aria-hidden="true" class="header-anchor">#</a> 遮罩层限制背景滚动</h2> <p>当遮罩层显示时控制body，固定body，当隐藏遮罩层的时候取消对body的控制</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> bodyElement <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token keyword">let</span> top <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">stopBodyScroll</span> <span class="token punctuation">(</span><span class="token parameter">isFixed</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isFixed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    top <span class="token operator">=</span> window<span class="token punctuation">.</span>scrollY
    bodyElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">'fixed'</span>
    bodyElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token operator">-</span>top <span class="token operator">+</span> <span class="token string">'px'</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    bodyElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">''</span>
    bodyElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">''</span>
    window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> top<span class="token punctuation">)</span> <span class="token comment">// 回到原先的top</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="监听storage事件"><a href="#监听storage事件" aria-hidden="true" class="header-anchor">#</a> 监听storage事件</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  同域名下非当前页的localStorage/sessionStorage数据改变都会触发storage事件</span>
<span class="token comment">// 用户跨项目通信（例如用户信息数据刷新等）</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;storage&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="历史管理"><a href="#历史管理" aria-hidden="true" class="header-anchor">#</a> 历史管理</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//*.vue</span>
<span class="token comment">//控制回退地址</span>
<span class="token comment">//适用多项目跳转，指定返回路径</span>
<span class="token comment">//使用场景：forward a=&gt;b=&gt;c,back c=&gt;a,跳过b</span>
 methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//回退地址</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token constant">URL_USER_CENTER</span><span class="token punctuation">;</span><span class="token comment">//指定回退地址</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//创建历史记录，第一个state为null</span>
 <span class="token function">beforeCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> url<span class="token punctuation">:</span> <span class="token constant">URL_USER_CENTER</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token comment">//监听popstate事件</span>
 <span class="token function">activated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;popstate&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>callback<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//移除popstate事件，使监听只作用在当前页面</span>
 <span class="token function">deactivated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;popstate&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>callback<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
<span class="token comment">//**********************************************//</span>

<span class="token comment">// 历史记录堆栈</span>
window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>url<span class="token punctuation">:</span>location<span class="token punctuation">.</span>href<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//保存跳转源地址</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname <span class="token operator">!=</span> <span class="token string">&quot;/msgCenter/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;referrer&quot;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span>referrer<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 监听返回/前进</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">&quot;popstate&quot;</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> state <span class="token operator">=</span> e<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token comment">//第一个页面加载时 state 为空</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>state<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//跳转地址</span>
      location<span class="token punctuation">.</span>href <span class="token operator">=</span> sessionS<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;referrer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> url <span class="token operator">=</span> state<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
    <span class="token comment">//不想回退的地址，正则</span>
    <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex">/openId=/i</span><span class="token punctuation">;</span>
    <span class="token comment">//跳回源地址条件判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">paseUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>pathname <span class="token operator">==</span> <span class="token string">&quot;/msgCenter/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      location<span class="token punctuation">.</span>href <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;referrer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="visibilitychange-事件；用于判断用户是否离开当前页面"><a href="#visibilitychange-事件；用于判断用户是否离开当前页面" aria-hidden="true" class="header-anchor">#</a> VisibilityChange 事件；用于判断用户是否离开当前页面</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 页面的 visibility 属性可能返回三种状态 </span>
<span class="token comment">// prerender，visible 和 hidden </span>
<span class="token keyword">let</span> pageVisibility <span class="token operator">=</span> document<span class="token punctuation">.</span>visibilityState<span class="token punctuation">;</span> 
<span class="token comment">// 监听 visibility change 事件 </span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'visibilitychange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 页面变为不可见时触发 </span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">==</span> <span class="token string">'hidden'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> 
  <span class="token comment">// 页面变为可见时触发 </span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>visibilityState <span class="token operator">==</span> <span class="token string">'visible'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//////////////////////////////////////////////////////////////</span>
<span class="token keyword">var</span> hiddenProperty <span class="token operator">=</span> <span class="token string">'hidden'</span> <span class="token keyword">in</span> document <span class="token operator">?</span> <span class="token string">'hidden'</span> <span class="token punctuation">:</span>    

   <span class="token string">'webkitHidden'</span> <span class="token keyword">in</span> document <span class="token operator">?</span> <span class="token string">'webkitHidden'</span> <span class="token punctuation">:</span>    

   <span class="token string">'mozHidden'</span> <span class="token keyword">in</span> document <span class="token operator">?</span> <span class="token string">'mozHidden'</span> <span class="token punctuation">:</span>    

   <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> visibilityChangeEvent <span class="token operator">=</span> hiddenProperty<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/hidden/i</span><span class="token punctuation">,</span> <span class="token string">'visibilitychange'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">onVisibilityChange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>document<span class="token punctuation">[</span>hiddenProperty<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    

       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'页面非激活'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

   <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'页面激活'</span><span class="token punctuation">)</span>

   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>visibilityChangeEvent<span class="token punctuation">,</span> onVisibilityChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="时间转换"><a href="#时间转换" aria-hidden="true" class="header-anchor">#</a> 时间转换</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//ios不支持2018-05-11 12:00:00格式转换</span>
<span class="token comment">// 兼容处理</span>
<span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2018-05-11 12:00:00'</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="判断空对象"><a href="#判断空对象" aria-hidden="true" class="header-anchor">#</a> 判断空对象</h2> <p>1.JSON.stringify()</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">'{}'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 空对象</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  <span class="token comment">// 非空对象</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2.Object.keys()</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 空对象</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  <span class="token comment">// 非空对象</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="函数式组件"><a href="#函数式组件" aria-hidden="true" class="header-anchor">#</a> 函数式组件</h2> <p>将组件标记为<code>functional</code>，这意味着它无状态（没有响应式数据），也没有实例（没有<code>this</code>上下文），它只是一个接受一些 prop 的函数.</p> <p>适用场景：</p> <ul><li>程序化地在多个组件中选择一个来代为渲染</li> <li>在将<code>children、props、data</code>传递给组件之前操作他们</li></ul> <p>优点：</p> <ul><li>因为函数式组件只是函数，所以渲染开销也低很多</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'my-component'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  functional<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token comment">// Props 是可选的,在 2.3.0 或以上的版本中，</span>
  <span class="token comment">// 所有组件上的特性都会被自动隐式解析为 prop。</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 为了弥补缺少的实例</span>
  <span class="token comment">// 提供第二个参数作为上下文</span>
  <span class="token function-variable function">render</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createElement<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="context包含字段"><a href="#context包含字段" aria-hidden="true" class="header-anchor">#</a> context包含字段</h3> <ul><li><code>props</code>：提供所有<code>prop</code>的对象</li> <li><code>children</code>：<code>VNode</code>子节点的数组</li> <li><code>slots</code>：一个函数，返回了包含所有插槽的对象</li> <li><code>scopedSlots</code>：（2.6.0+）一个暴露传入的作用域插槽的对象。也可以函数形式暴露普通插槽。</li> <li><code>data</code>：传递组件的整个数据对象，作为<code>createElement</code>的第二参数传入组件</li> <li><code>parent</code>：对父组件的引用</li> <li><code>listeners</code>：（2.3.0+）一个包含了所有父组件为当前组件注册的事件监听的对象。这是<code>data.on</code>的一个别名</li> <li><code>injections</code>：（2.3.0+）如果使用了<code>inject</code>选项，则该对象包含了应该被注入的属性</li></ul> <p>在普通组件中，没有被定义为prop的特性会自动添加到组件的根元素上，将已有的同名特性进行替换或者与其进行智能合并。然而函数式组件要求要显示定义该行为。</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'my-functional-button'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  functional<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createElement<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 完全透传任何特性、事件监听器、子节点等。</span>
    <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">,</span> context<span class="token punctuation">.</span>data<span class="token punctuation">,</span> context<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="单文件组件（2-5-0及以上）"><a href="#单文件组件（2-5-0及以上）" aria-hidden="true" class="header-anchor">#</a> 单文件组件（2.5.0及以上）</h3> <p>因为可以访问到其独立的上下文内容，所以可以使用 <code>data.attrs</code> 传递任何 HTML 特性，也可以使用 <code>listeners</code> (即 <code>data.on</code> 的别名) 传递任何事件监听器。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">functional</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>btn btn-primary<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>data.attrs<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>listeners<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="递归组件"><a href="#递归组件" aria-hidden="true" class="header-anchor">#</a> 递归组件</h2> <ul><li>需要给组件设置一个name</li> <li>需要有明确的结束条件</li></ul> <h2 id="其他"><a href="#其他" aria-hidden="true" class="header-anchor">#</a> 其他</h2> <ol><li>域名为localhost，参数会被URI转义</li> <li>p 标签中不允许放置任何块级元素</li></ol> <h2 id="echart-按需引入"><a href="#echart-按需引入" aria-hidden="true" class="header-anchor">#</a> echart 按需引入</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入 ECharts 主模块</span>
<span class="token keyword">var</span> echarts <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;echarts/lib/echarts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入柱状图</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;echarts/lib/chart/bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 引入提示框和标题组件</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;echarts/lib/component/tooltip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;echarts/lib/component/title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 基于准备好的dom，初始化echarts实例</span>
<span class="token keyword">var</span> myChart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;echart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 绘制图表</span>
myChart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">:</span> <span class="token string">&quot;ECharts 入门示例&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  tooltip<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  xAxis<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;衬衫&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;羊毛衫&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;雪纺衫&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;裤子&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;高跟鞋&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;袜子&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  yAxis<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  series<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">&quot;销量&quot;</span><span class="token punctuation">,</span>
      type<span class="token punctuation">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
      data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">9/30/2019, 1:39:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/yjm.github.io/notes/VUE/optimize.html">性能优化</a>→
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/yjm.github.io/assets/js/app.16d43aae.js" defer></script><script src="/yjm.github.io/assets/js/2.dc0e93a8.js" defer></script><script src="/yjm.github.io/assets/js/9.0c75ee61.js" defer></script>
  </body>
</html>
