<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS笔记 | 智宇星空</title>
    <meta name="description" content="前端学习资料">
    <link rel="icon" href="favicon.ico">
    
    <link rel="preload" href="/yjm.github.io/assets/css/0.styles.acbb5370.css" as="style"><link rel="preload" href="/yjm.github.io/assets/js/app.16d43aae.js" as="script"><link rel="preload" href="/yjm.github.io/assets/js/2.dc0e93a8.js" as="script"><link rel="preload" href="/yjm.github.io/assets/js/8.21d2d8cf.js" as="script"><link rel="prefetch" href="/yjm.github.io/assets/js/10.beb399c5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/11.ca77d212.js"><link rel="prefetch" href="/yjm.github.io/assets/js/12.45689107.js"><link rel="prefetch" href="/yjm.github.io/assets/js/13.aa1b3fbe.js"><link rel="prefetch" href="/yjm.github.io/assets/js/14.8a0e7fde.js"><link rel="prefetch" href="/yjm.github.io/assets/js/15.3633e7a9.js"><link rel="prefetch" href="/yjm.github.io/assets/js/16.b3294066.js"><link rel="prefetch" href="/yjm.github.io/assets/js/17.dc0284b9.js"><link rel="prefetch" href="/yjm.github.io/assets/js/18.cbdb9d59.js"><link rel="prefetch" href="/yjm.github.io/assets/js/19.5251db80.js"><link rel="prefetch" href="/yjm.github.io/assets/js/20.12bad232.js"><link rel="prefetch" href="/yjm.github.io/assets/js/21.09047114.js"><link rel="prefetch" href="/yjm.github.io/assets/js/22.fb0bb1fc.js"><link rel="prefetch" href="/yjm.github.io/assets/js/23.befdb5d2.js"><link rel="prefetch" href="/yjm.github.io/assets/js/24.acbdd388.js"><link rel="prefetch" href="/yjm.github.io/assets/js/25.dd404484.js"><link rel="prefetch" href="/yjm.github.io/assets/js/26.bfe88547.js"><link rel="prefetch" href="/yjm.github.io/assets/js/27.b18b740d.js"><link rel="prefetch" href="/yjm.github.io/assets/js/28.4e88ab0e.js"><link rel="prefetch" href="/yjm.github.io/assets/js/29.e282f883.js"><link rel="prefetch" href="/yjm.github.io/assets/js/3.ba283e77.js"><link rel="prefetch" href="/yjm.github.io/assets/js/30.d6ff8809.js"><link rel="prefetch" href="/yjm.github.io/assets/js/31.2637266c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/32.557aaf69.js"><link rel="prefetch" href="/yjm.github.io/assets/js/33.88f4e582.js"><link rel="prefetch" href="/yjm.github.io/assets/js/34.dae3780d.js"><link rel="prefetch" href="/yjm.github.io/assets/js/35.6b9506b5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/36.858c4d62.js"><link rel="prefetch" href="/yjm.github.io/assets/js/37.f8d863af.js"><link rel="prefetch" href="/yjm.github.io/assets/js/38.a6cd0274.js"><link rel="prefetch" href="/yjm.github.io/assets/js/39.ddf074bc.js"><link rel="prefetch" href="/yjm.github.io/assets/js/4.5942c30c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/40.04216fe1.js"><link rel="prefetch" href="/yjm.github.io/assets/js/41.8ef5b19c.js"><link rel="prefetch" href="/yjm.github.io/assets/js/42.99d6c4a5.js"><link rel="prefetch" href="/yjm.github.io/assets/js/43.6af8c75b.js"><link rel="prefetch" href="/yjm.github.io/assets/js/5.4c6ec876.js"><link rel="prefetch" href="/yjm.github.io/assets/js/6.82ba9ee8.js"><link rel="prefetch" href="/yjm.github.io/assets/js/7.d5846097.js"><link rel="prefetch" href="/yjm.github.io/assets/js/9.0c75ee61.js">
    <link rel="stylesheet" href="/yjm.github.io/assets/css/0.styles.acbb5370.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/yjm.github.io/" class="home-link router-link-active"><!----> <span class="site-name">智宇星空</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/yjm.github.io/notes/VUE/" class="nav-link">前端笔记</a></div><div class="nav-item"><a href="/yjm.github.io/doc/" class="nav-link">资源导航</a></div><div class="nav-item"><a href="https://github.com/Jameel01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/yjm.github.io/notes/VUE/" class="nav-link">前端笔记</a></div><div class="nav-item"><a href="/yjm.github.io/doc/" class="nav-link">资源导航</a></div><div class="nav-item"><a href="https://github.com/Jameel01" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/VUE/" class="sidebar-link">vue 开发笔记</a></li><li><a href="/yjm.github.io/notes/VUE/optimize.html" class="sidebar-link">性能优化</a></li><li><a href="/yjm.github.io/notes/VUE/vuecli.html" class="sidebar-link">Vue-CLI</a></li><li><a href="/yjm.github.io/notes/VUE/VUEX/" class="sidebar-link">vuex</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>React</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/REACT/" class="sidebar-link">React 开发笔记</a></li><li><a href="/yjm.github.io/notes/REACT/render.html" class="sidebar-link">React 渲染</a></li><li><a href="/yjm.github.io/notes/REACT/ReactApi.html" class="sidebar-link">React api</a></li><li><a href="/yjm.github.io/notes/REACT/Redux.html" class="sidebar-link">Redux</a></li><li><a href="/yjm.github.io/notes/REACT/Taro.html" class="sidebar-link">taro组件构子</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/JS/" class="active sidebar-link">JS笔记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/JS/#设计模式" class="sidebar-link">设计模式</a></li><li class="sidebar-sub-header"><a href="/yjm.github.io/notes/JS/#plugins-插件" class="sidebar-link">plugins 插件</a></li></ul></li><li><a href="/yjm.github.io/notes/JS/JavaScript-1.html" class="sidebar-link">JavaScript原理</a></li><li><a href="/yjm.github.io/notes/JS/es6.html" class="sidebar-link">ES6 语法</a></li><li><a href="/yjm.github.io/notes/JS/es5.html" class="sidebar-link">ES5</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript 常用语法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/typescript/type.html" class="sidebar-link">基础类型</a></li><li><a href="/yjm.github.io/notes/typescript/declare.html" class="sidebar-link">变量声明</a></li><li><a href="/yjm.github.io/notes/typescript/interface.html" class="sidebar-link">接口</a></li><li><a href="/yjm.github.io/notes/typescript/class.html" class="sidebar-link">类</a></li><li><a href="/yjm.github.io/notes/typescript/function.html" class="sidebar-link">函数</a></li><li><a href="/yjm.github.io/notes/typescript/generic.html" class="sidebar-link">泛型</a></li><li><a href="/yjm.github.io/notes/typescript/inference.html" class="sidebar-link">类型推断</a></li><li><a href="/yjm.github.io/notes/typescript/advance.html" class="sidebar-link">高级类型</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DOM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/DOM/" class="sidebar-link">DOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/CSS/" class="sidebar-link">CSS开发笔记</a></li><li><a href="/yjm.github.io/notes/CSS/shapes/" class="sidebar-link">/notes/CSS/shapes/</a></li><li><a href="/yjm.github.io/notes/CSS/sass.html" class="sidebar-link">Dart-Sass</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/WEBPACK/" class="sidebar-link">webpack 性能优化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>IOS问题库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/IOS/" class="sidebar-link">ios 问题库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/window/" class="sidebar-link">Event Loop</a></li><li><a href="/yjm.github.io/notes/window/HTTP/" class="sidebar-link">HTTP协议</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>RegExp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/REGEXP/" class="sidebar-link">正则表达式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>git</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/GIT/" class="sidebar-link">git 三种工作流程</a></li><li><a href="/yjm.github.io/notes/GIT/gitflow.html" class="sidebar-link">git-flow 的工作流程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/yjm.github.io/notes/OTHER/" class="sidebar-link">其他</a></li><li><a href="/yjm.github.io/notes/OTHER/NPM.html" class="sidebar-link">verdaccio 私有npm仓库搭建</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js笔记"><a href="#js笔记" aria-hidden="true" class="header-anchor">#</a> JS笔记</h1> <h2 id="设计模式"><a href="#设计模式" aria-hidden="true" class="header-anchor">#</a> 设计模式</h2> <h3 id="this、call-apply"><a href="#this、call-apply" aria-hidden="true" class="header-anchor">#</a> this、call/apply</h3> <h3 id="this"><a href="#this" aria-hidden="true" class="header-anchor">#</a> this</h3> <ul><li>在对象内的方法，this指向这个对象</li> <li>在普通函数内容，this指向全局变量（window对象）</li> <li>在构造器内，this指向实例对象</li> <li>Function.prototype.call(),Function.prototype.apply() 动态传入this指向</li></ul> <h3 id="this的丢失"><a href="#this的丢失" aria-hidden="true" class="header-anchor">#</a> this的丢失</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    myName<span class="token punctuation">:</span> <span class="token string">'sven'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getName</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> obj<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：'sven'</span>
<span class="token keyword">var</span> getName2 <span class="token operator">=</span> obj<span class="token punctuation">.</span>getName<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token function">getName2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出：undefined</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>在obj的getName方法内的this指向obj，当执行getName时输出obj下的myName属性<br>
当把getName赋给getName2时，getName2是一个普通函数，this指向window，所以取不到myName属性值</p></div> <h3 id="call-apply"><a href="#call-apply" aria-hidden="true" class="header-anchor">#</a> call/apply</h3> <p>用途：</p> <ul><li>改变this指向</li> <li>借用其他对象的方法(Array.prototype.push.call(this,参数))</li></ul> <p>区别：
call与apply用法几乎一样，除了传入参数形式不同
都接受两个参数，第一个为this对象的指向，第二个参数是传入函数的参数</p> <ul><li>apply第二个参数为数组或类数组</li> <li>call为具体参数，从第二个参数开始往后，每个参数被一次传入函数</li></ul> <p>选取：</p> <p>apply：当我们不关心具体有多少参数被传入函数时<br>
call：如果明确知道函数接受多少个参数，而且想一目了然的表达形参和实参的对应关系</p> <div class="warning custom-block"><p class="custom-block-title">注意：</p> <p>fn.apply(null,argument)，在严格模式中this指向null，默认模式中this指向默认的宿主对象</p></div> <h3 id="闭包"><a href="#闭包" aria-hidden="true" class="header-anchor">#</a> 闭包</h3> <p>闭包是指有权访问另一个函数作用域中的变量的函数。
常见创建闭包方式就是在一个函数内部创建另一个函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 块级作用域</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 函数中创建函数</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>变量的作用域</p> <ol><li>在函数内部声明一个变量，带var的则变成函数内部局部变量，不带var则变成全局变量</li> <li>函数可以创造函数作用域，函数内部可以访问外部变量，外部不能访问函数内部变量</li> <li>变量的搜索是从内到外，先从函数内部搜索，再顺着作用域链往外逐层搜索，一直搜索到全局对象为止</li></ol> <p>变量的生存周期</p> <ol><li>全局变量是永久的，除非主动注销，函数内部用var声明的局部变量当退出函数后便被注销了。</li> <li>闭包函数返回了一个函数，这个函数可以访问闭包函数内部变量，当这个返回的函数被引用，且这个函数也调用闭包函数的局部变量，那么这些被引用的闭包内部变量会一直存在。这个闭包结构，局部变量的生命被延续了</li></ol> <p>闭包的更多作用</p> <ol><li>闭包可以帮助把一些不需要暴露在全局的变量封装成“私有变量”</li> <li>延续局部变量的生命周期</li></ol> <p>闭包与内存管理</p> <ol><li>使用闭包的一部分原因是我们主动把一些变量封闭在闭包中，因为可能在以后还需要用到，把这些变量放在闭包和放在全局作用域，对内存方面的影响是一致的，这里 并不能说成是内存泄露。</li> <li>闭包的作用域链中保存着一些DOM节点，可能造成内存泄露。但这本身不是闭包的问题，也不是JavaScript的问题（与垃圾收集机制有关）</li> <li>在基于引用计数策略的垃圾回收机制中，如果两个对象之间形成循环引用，那么这两个对象都无法回收，但循环引用造成的内存泄露在本质上也不是闭包造成的</li> <li>处理方案就是手动将循环引用的变量设为<strong>null</strong></li></ol> <h4 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h4> <p>函数表达式特点：</p> <ol><li>函数表达式不同于函数声明。函数声明要求有名字，但函数表达式不需要。没有名字的函数表达式也可以叫做匿名函数</li> <li>在无法确定如何引用函数的情况下，递归函数就会变得比较复杂。</li> <li>递归函数应该始终使用arguments.callee来递归地调用自身，不要使用匿名函数。（严格模式arguments.callee不能使用，可以使用具名函数来实现递归调用）</li></ol> <p>当在函数内部定义了其他函数时，就创建了闭包。
闭包有权访问包含函数内部的所有变量，原理如下：</p> <ol><li>在后台执行环境中，闭包的作用域包含着它自己的作用域、包含函数作用域和全局作用域。</li> <li>通常，函数的作用域及其所有变量都会在函数执行后被销毁。</li> <li>但是，当函数返回了闭包一个时，这个函数的作用域将会一直在内存中保存到闭包不存在为止。</li></ol> <p>使用闭包模仿块级作用域要点如下：</p> <ol><li>创建并立即调用一个函数，这样既可以执行其中的代码，又不会在内存中留下对该函数的引用。</li> <li>结果就是函数内部的所有变量都会被立即销毁--除非将某些变量赋值给了包含作用域（外部作用域）中的变量</li> <li>函数声明后面不能跟圆括号，然而，函数表达式的后面可以跟圆括号。要将函数声明转换为函数表达式，只要给它加上一对圆括号即可</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 这里是块级作用域</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>这种做法可以减少闭包占用的内存问题，因为没有指向匿名函数的引用。只要函数执行完毕，就可以立即销毁其作用域链了</p> <p>闭包在对象中创建私有变量要点如下：</p> <ol><li>即使JavaScript中没有正式的私有对象属性的概念，但可以使用闭包来实现公有方法，而通过公有方法可以访问在包含作用域中定义的变量。</li> <li>有权访问私有变量的公有方法叫做特权方法。</li> <li>可以使用构造函数模式、原型模式来实现自定义类型的特权方法，也可以使用模块模式、增强的模块模式来实现单例的特权方法</li> <li>如果必须创建一个对象并以某些数据对其进行初始化，同时还要公开一些能够访问这些私有
数据的方法，那么就可以使用模块模式。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 增强的模块模式</span>
<span class="token keyword">var</span> application <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 私有变量和函数</span>
    <span class="token keyword">var</span> components <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化</span>
    components<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BaseComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 创建application的一个局部副本</span>
    <span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 公共接口</span>
    app<span class="token punctuation">.</span><span class="token function-variable function">getComponentCount</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> components<span class="token punctuation">.</span>length
    <span class="token punctuation">}</span>
    app<span class="token punctuation">.</span><span class="token function-variable function">getComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">component</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> component <span class="token operator">==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            components<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 返回这个副本</span>
    <span class="token keyword">return</span> app<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">注意：</p> <ol><li>因为创建闭包必维护须额外的作用域，所以过度使用它们可能会占用大量内存</li> <li>使用闭包和私有变量的一个明显的不足之处，多查找作用域中的一个层次，就会在一定程度上影响查找速度。</li></ol></div> <h3 id="高阶函数"><a href="#高阶函数" aria-hidden="true" class="header-anchor">#</a> 高阶函数</h3> <h3 id="函数节流"><a href="#函数节流" aria-hidden="true" class="header-anchor">#</a> 函数节流</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//核心代码</span>
<span class="token comment">//短时间内多次触发，用定时器延迟处理（有点防抖的意思）</span>
<span class="token keyword">var</span> <span class="token function-variable function">throttle</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">fn<span class="token punctuation">,</span> interval</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> __self <span class="token operator">=</span> fn<span class="token punctuation">,</span> <span class="token comment">// 保存需要被延迟执行的函数引用</span>
        timer<span class="token punctuation">,</span> <span class="token comment">// 定时器</span>
        firstTime <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 是否是第一次调用</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> arguments<span class="token punctuation">,</span>
            __me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> firstTime <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果是第一次调用，不需延迟执行</span>
            <span class="token function">__self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>__me<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> firstTime <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> timer <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果定时器还在，说明前一次延迟执行还没有完成</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 延迟一段时间执行</span>
            <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token function">__self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>__me<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> interval <span class="token operator">||</span> <span class="token number">500</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//实例</span>
window<span class="token punctuation">.</span>onresize <span class="token operator">=</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="分时函数"><a href="#分时函数" aria-hidden="true" class="header-anchor">#</a> 分时函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//核心代码</span>
<span class="token comment">//数据量大时，分批执行</span>
<span class="token keyword">var</span> <span class="token function-variable function">timeChunk</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">ary<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> count</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> obj<span class="token punctuation">,</span>
        t<span class="token punctuation">;</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">var</span> <span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span> count <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">,</span> ary<span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> obj <span class="token operator">=</span> ary<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fn</span><span class="token punctuation">(</span> obj <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        t <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> ary<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 如果全部节点都已经被创建好</span>
                <span class="token keyword">return</span> <span class="token function">clearInterval</span><span class="token punctuation">(</span> t <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 分批执行的时间间隔，也可以用参数的形式传入</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//实例</span>
<span class="token keyword">var</span> ary <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    ary<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> renderFriendList <span class="token operator">=</span> <span class="token function">timeChunk</span><span class="token punctuation">(</span> ary<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">n</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span> <span class="token string">'div'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> n<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span> div <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">renderFriendList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="惰性加载函数"><a href="#惰性加载函数" aria-hidden="true" class="header-anchor">#</a> 惰性加载函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//核心代码</span>
<span class="token comment">//进入条件分支后重写这个函数（希望执行的条件的函数）</span>
<span class="token keyword">var</span> <span class="token function-variable function">addEvent</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> window<span class="token punctuation">.</span>addEventListener <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function-variable function">addEvent</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span> type<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token boolean">false</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> window<span class="token punctuation">.</span>attachEvent <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function-variable function">addEvent</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span><span class="token function">attachEvent</span><span class="token punctuation">(</span> <span class="token string">'on'</span> <span class="token operator">+</span> type<span class="token punctuation">,</span> handler <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">addEvent</span><span class="token punctuation">(</span> elem<span class="token punctuation">,</span> type<span class="token punctuation">,</span> handler <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="模式"><a href="#模式" aria-hidden="true" class="header-anchor">#</a> 模式</h3> <p><img src="/yjm.github.io/assets/img/img-shejimoshi.a970fda4.png" alt="设计模式思维导图"></p> <h3 id="通用的惰性单例"><a href="#通用的惰性单例" aria-hidden="true" class="header-anchor">#</a> 通用的惰性单例</h3> <p><strong>单例模式定义</strong>：保证一个类仅有一个实例，并提供一个访问它的全局访问点</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 单例核心代码</span>
<span class="token comment">// 获取单例</span>
<span class="token keyword">var</span> <span class="token function-variable function">getSingle</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> result<span class="token punctuation">;</span><span class="token comment">//标志,只定义未赋值</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> result <span class="token operator">||</span> <span class="token punctuation">(</span>result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//如果存在&gt;返回result,不存在&gt;将参数赋值给result返回</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>getSingle与jq中的one方法有相同作用</li> <li>惰性单例技术只有在被调用时才执行，并且只创建唯一一个</li> <li>创建对象和管理单例的职责被分布在两个不同的方法中</li></ul> <h3 id="实例"><a href="#实例" aria-hidden="true" class="header-anchor">#</a> 实例</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建对象</span>
<span class="token keyword">var</span> <span class="token function-variable function">createLoginLayer</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'我是登录浮窗'</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> div<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//管理单例</span>
<span class="token keyword">var</span> createSingleLoginLayer <span class="token operator">=</span> <span class="token function">getSingle</span><span class="token punctuation">(</span>createLoginLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>

document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'loginBtn'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> loginLayer <span class="token operator">=</span> <span class="token function">createSingleLoginLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    loginLayer<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="策略模式"><a href="#策略模式" aria-hidden="true" class="header-anchor">#</a> 策略模式</h3> <p><strong>策略模式定义</strong>：定义一系列的算法，把它们一个个封装起来，并且使他们可以互相替换。</p> <p>策略模式的优点：</p> <ol><li>策略模式利用组合、委托和多态等技术思想，可以有效地规避多重条件选择语句</li> <li>策略模式提供了对开发-封闭原则的完美支持，将算法封装在独立的strategy中，使得它们易于切换，易于理解，易于扩展</li> <li>策略模式中的算法也可以复用在系统的其他地方，从而避免许多重复的复制粘贴工作</li> <li>在策略模式中利用组合和委托Context拥有执行算法的能力，这也是继承的一种更轻便的替代方案</li></ol> <p>在JavaScript语言中的策略模式中，策略类往往被函数所替代，这时策略模式就成为一种“隐形”的模式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 隐形的策略模式</span>
<span class="token keyword">var</span> <span class="token function-variable function">S</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">10</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">A</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">20</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">B</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">30</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">calculateBonus</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span>salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">calculateBonus</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10000 </span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 显示说明这是策略模式</span>
<span class="token keyword">var</span> strategies <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">S</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">10</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">A</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">20</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">B</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> salary <span class="token operator">*</span><span class="token number">30</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">calculateBonus</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>salary</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> strategies<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">calculateBonus</span><span class="token punctuation">(</span><span class="token constant">S</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10000 </span>
</code></pre></div><h3 id="代理模式"><a href="#代理模式" aria-hidden="true" class="header-anchor">#</a> 代理模式</h3> <p>代理模式是为一个对象提供一个代用品或占位符，以便控制对它的访问。</p> <p>在 JavaScript开发中最常用的是虚拟代理和缓存代理。虽然代理模式非常有用，但我们在编写业务代码的时候，往往不需要去预先猜测是否需要使用代理模式。当真正发现不方便直接访问某个对象的时候，再编写代理也不迟。</p> <p>代理的意义</p> <ol><li>能够更好的实现单一职责原则，</li> <li>通过代理模式给系统添加新行为，这是符合开放-封闭原则</li></ol> <p>代理和本体接口的一致性</p> <ol><li>用户可以放心地请求代理，他只关心是否能得到想要的结果</li> <li>在任何使用本体的地方都可以替换成使用代理</li></ol> <p>虚拟代理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 虚拟代理实现图片预加载</span>
<span class="token comment">// 代理接口与本体接口统一，可以随时取消代理，直接调用本体函数</span>
<span class="token comment">// 每个函数职责单一</span>
<span class="token comment">// 代理函数对系统新增方法，且不改变本体函数，符合开放-封闭原则</span>
<span class="token keyword">var</span> myImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> imgNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> src
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> proxyImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">;</span>
    img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">myImage</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>src<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">myImage</span><span class="token punctuation">(</span><span class="token string">'loading.gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        img<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">proxyImage</span><span class="token punctuation">(</span><span class="token string">'imgSrc.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>缓存代理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 缓存代理-计算乘积</span>
<span class="token comment">// 代理接口与本体接口统一，可以随时取消代理，直接调用本体函数</span>
<span class="token comment">// 每个函数职责单一</span>
<span class="token comment">// 代理函数对计算值进行缓存，且不改变本体函数，符合开放-封闭原则</span>
<span class="token keyword">var</span> <span class="token function-variable function">mult</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开始计算乘积'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token operator">=</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>l<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a <span class="token operator">=</span> a <span class="token operator">*</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">proxyMult</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args <span class="token keyword">in</span> cache<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cache<span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mult</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">proxyMult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出：24</span>
<span class="token function">proxyMult</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//输出：24(cache)</span>
</code></pre></div><h3 id="装饰者模式"><a href="#装饰者模式" aria-hidden="true" class="header-anchor">#</a> 装饰者模式</h3> <p>给对象动态地增加职责的方式称为装饰者（decorator）模式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">before</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">beforefn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> _self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">beforefn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">_self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">after</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">afterfn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> _self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token function">_self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">afterfn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>装饰者模式和代理模式区别：最主要的区别在于它们的意图和设计目的。</p> <ol><li>代理模式的目的是，当直接访问本体不方便或者不符合需求时，为这个本体提供一个代替者。本体定义了关键功能，而代理提供或拒绝它的访问，或者在访问本体之前做一些额外的事情。装饰者模式的作用就是为对象动态加入行为。</li> <li>代理模式强调一种关系，这种关系可以静态的表达，这种关系在一开始就可以被确定。装饰者模式用于一开始不能确定对象的全部功能时。</li> <li>代理模式通常只有一层代理-本体的引用，而装饰者模式经常会形成一条长长的装饰链。</li></ol> <h3 id="组合模式"><a href="#组合模式" aria-hidden="true" class="header-anchor">#</a> 组合模式</h3> <p>适用场景：</p> <ol><li><code>表示对象的部分-整体层次结构</code>。组合模式可以方便地构造一棵树来表示对象的部分-整体结构。特别是我们在开发期间不确定这棵树到底存在多少层次的时候。在树的构造最终完成之后，只需要通过请求树的最顶层对象，便能对整棵树做统一的操作。<code>在组合模式中增加和删除树的节点非常方便，并且符合开放-封闭原则</code>。</li> <li><code>客户希望统一对待树种的所有对象</code>。组合模式使客户可以忽略组合对象和叶对象的区别，客户在面对这课树的时候，不用关心当前在处理的对象是组合对象还是叶对象，也就不用写一堆if，else语句来分别处理他们。<code>组合对象和叶对象会各自做自己正确的事情，这是组合模式最重要的能力</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 组合模式的例子——扫描文件夹</span>
<span class="token comment">// 忽略组合对象和叶对象区别，都拥scan方法</span>
<span class="token comment">// 只需操作最顶层对象scan方法，既可以操作整个树</span>
<span class="token comment">// 自由增加和删除树节点</span>
<span class="token comment">// 组合对象和叶对象做不同的事</span>
<span class="token keyword">var</span> <span class="token function-variable function">Folder</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Folder</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Folder</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">scan</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开始扫描文件夹：'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 遍历执行扫描</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>file<span class="token punctuation">,</span>files <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">;</span>file <span class="token operator">=</span> files<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        file<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">File</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token class-name">File</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'文件下面不能再添加文件'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">File</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">scan</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'开始扫描文件：'</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> folder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">'学习资料'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> folder1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">'JavaScript'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> folder2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">'JQuery'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> file1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">'JavaScript设计模式与开发实践'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> file2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">'精通JQuery'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> file3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">'重构与模式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

folder1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file1<span class="token punctuation">)</span><span class="token punctuation">;</span>
folder2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file2<span class="token punctuation">)</span><span class="token punctuation">;</span>

folder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>folder1<span class="token punctuation">)</span><span class="token punctuation">;</span>
folder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>folder2<span class="token punctuation">)</span><span class="token punctuation">;</span>
folder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> folder3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Folder</span><span class="token punctuation">(</span><span class="token string">'Nodejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> file4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">'深入浅出Node.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> file5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">'JavaScript语言精髓与编程实践'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

folder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>folder3<span class="token punctuation">)</span><span class="token punctuation">;</span>
folder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>file5<span class="token punctuation">)</span><span class="token punctuation">;</span>
folder<span class="token punctuation">.</span><span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// folder.files 存储函数引用</span>
<span class="token comment">// [</span>
<span class="token comment">//     {</span>
<span class="token comment">//         name: 'JavaScript',</span>
<span class="token comment">//         files: [</span>
<span class="token comment">//             {</span>
<span class="token comment">//                 name: 'JavaScript设计模式与开发实践'</span>
<span class="token comment">//             }</span>
<span class="token comment">//         ]</span>
<span class="token comment">//     },</span>
<span class="token comment">//     {</span>
<span class="token comment">//         name: 'JQuery',</span>
<span class="token comment">//         files: [</span>
<span class="token comment">//             {</span>
<span class="token comment">//                 name: '精通JQuery'</span>
<span class="token comment">//             }</span>
<span class="token comment">//         ]</span>
<span class="token comment">//     },</span>
<span class="token comment">//     {</span>
<span class="token comment">//         name: '重构与模式'</span>
<span class="token comment">//     },</span>
<span class="token comment">//     {</span>
<span class="token comment">//         name: 'Nodejs',</span>
<span class="token comment">//         files: []</span>
<span class="token comment">//     },</span>
<span class="token comment">//     {</span>
<span class="token comment">//         name: 'JavaScript语言精髓与编程实践'</span>
<span class="token comment">//     }</span>
<span class="token comment">// ]</span>
</code></pre></div><h3 id="模板方法模式"><a href="#模板方法模式" aria-hidden="true" class="header-anchor">#</a> 模板方法模式</h3> <p>基于继承的设计模式，是一种典型的通过封装变化提高系统扩展性的设计模式。</p> <p>在传统的面向对象语言中，一个运用了模板方法模式的程序中，子类的方法种类和执行顺序都是不变的，所以我们把这部分逻辑抽象到父类的模板方法里面。而子类的方法具体怎么实现则是可变的，于是我们把这部分变化的逻辑封装到子类中。通过增加新的子类，我们便能给系统增加新的功能，并不需要改动抽象父类以及其他子类，这也是符合开放封闭原则的。</p> <p><code>我们很多时候都不需要依样画瓢地去实现一个模版方法模式，高阶函数是更好的选择</code>。</p> <p>结构组成：</p> <ol><li>抽象父类：封装了子类的算法框架，包括实现一些公共方法以及封装子类中所有方法的执行顺序</li> <li>实现子类：继承抽象父类，继承整个算法结构，并且可以选择重写父类的方法</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模板方法模式</span>
<span class="token comment">// 抽象父类</span>
<span class="token comment">// 子类继承父类之后，父类通知子类执行这些方法</span>
<span class="token keyword">var</span> <span class="token function-variable function">Beverage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 具体方法</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">boilWater</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把水煮沸'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 抽象方法</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">brew</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 子类方法实现检测</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'子类必须重写brew方法'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">pourInCup</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'子类必须重写pourInCup方法'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addCondiments</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'子类必须重写addCondiments方法'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 挂钩，修改默认行为</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">customerWantsCondiments</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认需要调料</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">// 模板，控制方法调用与方法执行顺序</span>
<span class="token class-name">Beverage</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">boilWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 如果挂钩返回true，则需要调料</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">customerWantsCondiments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCondiments</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现子类，继承父类抽象方法并具体实现该方法</span>
<span class="token keyword">var</span> <span class="token function-variable function">CoffeeWithHook</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 继承父类</span>
<span class="token class-name">CoffeeWithHook</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Beverage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 实现父类抽象方法</span>
<span class="token class-name">CoffeeWithHook</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">brew</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用沸水冲泡咖啡'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">CoffeeWithHook</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">pourInCup</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把咖啡倒进杯子'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">CoffeeWithHook</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addCondiments</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'加糖和牛奶'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 修改父类模板默认行为</span>
<span class="token class-name">CoffeeWithHook</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">customerWantsCondiments</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'请问需要调料吗？'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> coffeeWithHook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CoffeeWithHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
coffeeWithHook<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 高阶函数</span>
<span class="token keyword">var</span> <span class="token function-variable function">Beverage</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token function-variable function">boilWater</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把水煮沸'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> brew <span class="token operator">=</span> param<span class="token punctuation">.</span>brew <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'必须传递brew方法'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> pourInCup <span class="token operator">=</span> param<span class="token punctuation">.</span>pourInCup <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'必须传递pourInCup方法'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> addCondiments <span class="token operator">=</span> param<span class="token punctuation">.</span>addCondiments <span class="token operator">||</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'必须传递addCondiments方法'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">boilWater</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">pourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addCondiments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant">F</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Coffee <span class="token operator">=</span> <span class="token function">Beverage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">brew</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用沸水冲泡咖啡'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">pourInCup</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'把咖啡倒进杯子'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">addCondiments</span><span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'加糖和牛奶'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> coffee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Coffee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
coffee<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="享元模式"><a href="#享元模式" aria-hidden="true" class="header-anchor">#</a> 享元模式</h3> <p>享元（flyweight）模式是一种用于性能优化的模式
适用场景：</p> <ol><li>一个程序中使用了大量的相似对象</li> <li>由于使用了大量对象，造成很大的内存开销</li> <li>剥离出对象的外部状态之后，可以用相对较少的共享对象取代大量对象</li> <li>对象的大多数状态都可以变为外部状态</li></ol> <p>享元模式要求将对象的属性<code>划分为内部状态与外部状态</code>（状态在这里通常指属性）。享元模式的目标是尽量减少共享对象的数量，关于如何划分内部状态和外部状态，下面的几条经验提供了一些指引。</p> <ol><li>内部状态存储于对象内部</li> <li>内部状态可以被一些对象共享</li> <li>内部状态独立于具体的场景，通常不会改变</li> <li>外部状态取决于具体的场景，并根据场景而变化，外部状态不能被共享</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 享元模式-文件上传</span>


<span class="token keyword">var</span> <span class="token function-variable function">Upload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">uploadType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 内部状态，可共享</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>uploadType <span class="token operator">=</span> uploadType
<span class="token punctuation">}</span>
<span class="token class-name">Upload</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">delFile</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uploadManager<span class="token punctuation">.</span><span class="token function">setExternalState</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fileSize <span class="token operator">&lt;</span> <span class="token number">3000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'确认要删除该文件吗？'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> UploadFactory <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> createdFlyWeightObjs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">create</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">uploadType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>createdFlyWeightObjs<span class="token punctuation">[</span>uploadType<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> createdFlyWeightObjs<span class="token punctuation">[</span>uploadType<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> createdFlyWeightObjs<span class="token punctuation">[</span>uploadType<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Upload</span><span class="token punctuation">(</span>uploadType<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> uploadManager <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> uploadDatabase <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">add</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> uploadType<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> fileSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> flyWeightObj <span class="token operator">=</span> UploadFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>uploadType<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'&lt;span&gt;文件名称:'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileName <span class="token operator">+</span> <span class="token string">', 文件大小: '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fileSize <span class="token operator">+</span> <span class="token string">'&lt;/span&gt;'</span> <span class="token operator">+</span>
                <span class="token string">'&lt;button class=&quot;delFile&quot;&gt;删除&lt;/button&gt;'</span><span class="token punctuation">;</span>

            dom<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.delFile'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                flyWeightObj<span class="token punctuation">.</span><span class="token function">delFile</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 外部状态</span>
            uploadDatabase<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                fileName<span class="token punctuation">:</span> fileName<span class="token punctuation">,</span>
                fileSize<span class="token punctuation">:</span> fileSize<span class="token punctuation">,</span>
                dom<span class="token punctuation">:</span> dom
            <span class="token punctuation">}</span>
            
            <span class="token keyword">return</span> flyWeightObj<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">setExternalState</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> flyWeightObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> uploadData <span class="token operator">=</span> uploadDatabase<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token keyword">in</span> uploadData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                flyWeightObj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> uploadData<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> id <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function-variable function">startUpload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">uploadType<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> file<span class="token punctuation">;</span> file <span class="token operator">=</span> files<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> uploadObj <span class="token operator">=</span> uploadManager<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">++</span>id<span class="token punctuation">,</span> uploadType<span class="token punctuation">,</span> file<span class="token punctuation">.</span>fileName<span class="token punctuation">,</span> file<span class="token punctuation">.</span>fileSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">startUpload</span><span class="token punctuation">(</span><span class="token string">'plugin'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'1.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'2.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">3000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'3.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">4000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'4.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">5000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">startUpload</span><span class="token punctuation">(</span><span class="token string">'flash'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'5.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'6.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">3000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        fileName<span class="token punctuation">:</span> <span class="token string">'7.txt'</span><span class="token punctuation">,</span>
        fileSize<span class="token punctuation">:</span> <span class="token number">4000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="订阅-发布模式"><a href="#订阅-发布模式" aria-hidden="true" class="header-anchor">#</a> 订阅-发布模式</h3> <p>发布 — 订阅模式又叫观察者模式，它定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知。在 JavaScript开发中，我们一般用事件模型来替代传统的发布 — 订阅模式</p> <p>优点：1.在时间上解耦（可用在异步编程），2.在对象之间解耦<br>
缺点：</p> <ol><li>消耗内存：创建订阅者本身要消耗一定的时间和内存，而且当订阅一个消息后，可能该消息不会发生，但是这个订阅者会始终存在于内存中。</li> <li>过渡使用导致难以维护和理解：如果过渡使用，对象与对象之间的必要联系也被埋藏在背后，会导致程序难以跟踪维护和理解</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> Event <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> _default <span class="token operator">=</span> <span class="token string">'default'</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> _listen<span class="token punctuation">,</span>
            _trigger<span class="token punctuation">,</span>
            _remove<span class="token punctuation">,</span>
            _shift <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>shift<span class="token punctuation">,</span>
            _unshift <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>unshift<span class="token punctuation">,</span>
            namespaceCache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            _create<span class="token punctuation">,</span>

            <span class="token function-variable function">each</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">ary<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> ret<span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> ary<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> n <span class="token operator">=</span> ary<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    ret <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> i<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token function-variable function">_listen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
            cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function-variable function">_remove</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> cache<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function-variable function">_trigger</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> cache <span class="token operator">=</span> <span class="token function">_shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">,</span>
                key <span class="token operator">=</span> <span class="token function">_shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">,</span>
                args <span class="token operator">=</span> arguments<span class="token punctuation">,</span>
                _self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>
                ret<span class="token punctuation">,</span>
                stack <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack <span class="token operator">||</span> <span class="token operator">!</span>stack<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">each</span><span class="token punctuation">(</span>stack<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_self<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function-variable function">_create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">namespace</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> namespace <span class="token operator">=</span> namespace <span class="token operator">||</span> _default<span class="token punctuation">;</span>
            <span class="token keyword">let</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                offlinesStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">// 离线事件</span>
                ret <span class="token operator">=</span> <span class="token punctuation">{</span>
                    <span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">_listen</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>offlinesStack <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>last <span class="token operator">===</span> <span class="token string">'last'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            offlinesStack<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> offlinesStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            <span class="token function">each</span><span class="token punctuation">(</span>offlinesStack<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>
                        offlinesStack <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function">one</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">_remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">_remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> cache<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">let</span> fn<span class="token punctuation">,</span> args<span class="token punctuation">,</span> _self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
                        <span class="token function">_unshift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
                        <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> <span class="token function">_trigger</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>_self<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>

                        <span class="token keyword">if</span> <span class="token punctuation">(</span>offlinesStack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> offlinesStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token keyword">return</span> namespace <span class="token operator">?</span> <span class="token punctuation">(</span>namespaceCache<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span> <span class="token operator">?</span> namespaceCache<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span> <span class="token punctuation">:</span> namespaceCache<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">)</span> <span class="token punctuation">:</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            create<span class="token punctuation">:</span> _create<span class="token punctuation">,</span>
            <span class="token function">one</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                event<span class="token punctuation">.</span><span class="token function">one</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">remove</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                event<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                event<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> last<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> event <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                event<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

Event<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Event<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

Event<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'namespace1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Event<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'namespace1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
Event<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'namespace2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
Event<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'namespace2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">// 1 1 2</span>
</code></pre></div><h3 id="开放-封闭原则"><a href="#开放-封闭原则" aria-hidden="true" class="header-anchor">#</a> 开放-封闭原则</h3> <p>软件实体（类、模块、函数）等应该是可以扩展的，但是不可修改</p> <ul><li>过多的条件分支语句是造成程序违反开放封闭原则的一个常见原因</li> <li>通过封装变化的方式，可以把系统中稳定不变的部分和容易变化的部分隔离开来。</li> <li><code>放置挂钩（hook）</code>也是分离变化的一种方式。我们在程序有可能发生变化的地方放置一个挂
钩，挂钩的返回结果决定了程序的下一步走向。这样一来，原本的代码执行路径上就出现了一个
分叉路口，程序未来的执行方向被预埋下多种可能性。</li> <li><code>回调函数</code>是一种特殊的挂钩。我们可以把一部分易于变化的逻辑封装在回调函数里，然后把
回调函数当作参数传入一个稳定和封闭的函数中。当回调函数被执行的时候，程序就可以因为回
调函数的内部逻辑不同，而产生不同的结果。</li></ul> <h3 id="运算符优先级"><a href="#运算符优先级" aria-hidden="true" class="header-anchor">#</a> 运算符优先级</h3> <p>The following table is ordered from highest (20) to lowest (1) precedence.</p> <table class="fullwidth-table"><tbody><tr><th>Precedence</th> <th>Operator type</th> <th>Associativity</th> <th>Individual operators</th></tr> <tr><td>20</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Grouping" title="The grouping operator ( ) controls the precedence of evaluation in expressions.">Grouping</a></td> <td>n/a</td> <td><code>( … )</code></td></tr> <tr><td colspan="1" rowspan="5">19</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Property_Accessors#Dot_notation" title="Property accessors provide access to an object's properties by using the dot notation or the bracket notation.">Member Access</a></td> <td>left-to-right</td> <td><code>… . …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Property_Accessors#Bracket_notation" title="Property accessors provide access to an object's properties by using the dot notation or the bracket notation.">Computed Member Access</a></td> <td>left-to-right</td> <td><code>… [ … ]</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/new" title="The new operator lets developers create an instance of a user-defined object type or of one of the built-in object types that has a constructor function."><code>new</code></a> (with argument list)</td> <td>n/a</td> <td><code>new … ( … )</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Guide/Functions">Function Call</a></td> <td>left-to-right</td> <td><code>… ( <var>… </var>)</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining">Optional chaining</a></td> <td>left-to-right</td> <td><code>?.</code></td></tr> <tr><td rowspan="1">18</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/new" title="The new operator lets developers create an instance of a user-defined object type or of one of the built-in object types that has a constructor function."><code>new</code></a> (without argument list)</td> <td>right-to-left</td> <td><code>new …</code></td></tr> <tr><td rowspan="2">17</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Increment" title="Arithmetic operators take numerical values (either literals or variables) as their operands and return a single numerical value. The standard arithmetic operators are addition (+), subtraction (-), multiplication (*), and division (/).">Postfix Increment</a></td> <td colspan="1" rowspan="2">n/a</td> <td><code>… ++</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Decrement" title="Arithmetic operators take numerical values (either literals or variables) as their operands and return a single numerical value. The standard arithmetic operators are addition (+), subtraction (-), multiplication (*), and division (/).">Postfix Decrement</a></td> <td><code>… --</code></td></tr> <tr><td colspan="1" rowspan="10">16</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Logical_NOT">Logical NOT</a></td> <td colspan="1" rowspan="10">right-to-left</td> <td><code>! …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_NOT">Bitwise NOT</a></td> <td><code>~ …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Unary_plus">Unary Plus</a></td> <td><code>+ …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Unary_negation">Unary Negation</a></td> <td><code>- …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Increment">Prefix Increment</a></td> <td><code>++ …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Decrement">Prefix Decrement</a></td> <td><code>-- …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/typeof" title="The typeof operator returns a string indicating the type of the unevaluated operand."><code>typeof</code></a></td> <td><code>typeof …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/void" title="The void operator evaluates the given expression and then returns undefined."><code>void</code></a></td> <td><code>void …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/delete" title="The JavaScript delete operator removes a property from an object; if no more references to the same property are held, it is eventually released automatically."><code>delete</code></a></td> <td><code>delete …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/await" title="The await operator is used to wait for a Promise. It can only be used inside&amp;nbsp;an async function."><code>await</code></a></td> <td><code>await …</code></td></tr> <tr><td>15</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Exponentiation">Exponentiation</a></td> <td>right-to-left</td> <td><code>… ** …</code></td></tr> <tr><td rowspan="3">14</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Multiplication">Multiplication</a></td> <td colspan="1" rowspan="3">left-to-right</td> <td><code>… * …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Division">Division</a></td> <td><code>… / …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Remainder">Remainder</a></td> <td><code>… % …</code></td></tr> <tr><td rowspan="2">13</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Addition">Addition</a></td> <td colspan="1" rowspan="2">left-to-right</td> <td><code>… + …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Subtraction">Subtraction</a></td> <td><code>… - …</code></td></tr> <tr><td rowspan="3">12</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">Bitwise Left Shift</a></td> <td colspan="1" rowspan="3">left-to-right</td> <td><code>… &lt;&lt; …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">Bitwise Right Shift</a></td> <td><code>… &gt;&gt; …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators">Bitwise Unsigned Right Shift</a></td> <td><code>… &gt;&gt;&gt; …</code></td></tr> <tr><td rowspan="6">11</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Less_than_operator">Less Than</a></td> <td colspan="1" rowspan="6">left-to-right</td> <td><code>… &lt; …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Less_than__or_equal_operator">Less Than Or Equal</a></td> <td><code>… &lt;= …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Greater_than_operator">Greater Than</a></td> <td><code>… &gt; …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Greater_than_or_equal_operator">Greater Than Or Equal</a></td> <td><code>… &gt;= …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/in" title="The in operator returns true if the specified property is in the specified object or its prototype chain."><code>in</code></a></td> <td><code>… in …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/instanceof" title="The instanceof operator tests whether the prototype property of a constructor appears anywhere in the prototype chain of an object."><code>instanceof</code></a></td> <td><code>… instanceof …</code></td></tr> <tr><td rowspan="4">10</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Equality">Equality</a></td> <td colspan="1" rowspan="4">left-to-right</td> <td><code>… == …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Inequality">Inequality</a></td> <td><code>… != …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Identity">Strict Equality</a></td> <td><code>… === …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Nonidentity">Strict Inequality</a></td> <td><code>… !== …</code></td></tr> <tr><td>9</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_AND">Bitwise AND</a></td> <td>left-to-right</td> <td><code>… &amp; …</code></td></tr> <tr><td>8</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_XOR">Bitwise XOR</a></td> <td>left-to-right</td> <td><code>… ^ …</code></td></tr> <tr><td>7</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators#Bitwise_OR">Bitwise OR</a></td> <td>left-to-right</td> <td><code>… | …</code></td></tr> <tr><td>6</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Logical_AND">Logical AND</a></td> <td>left-to-right</td> <td><code>… &amp;&amp; …</code></td></tr> <tr><td>5</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Logical_OR">Logical OR</a></td> <td>left-to-right</td> <td><code>… || …</code></td></tr> <tr><td>4</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator">Conditional</a></td> <td>right-to-left</td> <td><code>… ? … : …</code></td></tr> <tr><td rowspan="13">3</td> <td rowspan="13"><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Assignment_Operators">Assignment</a></td> <td rowspan="13">right-to-left</td> <td><code>… = …</code></td></tr> <tr><td><code>… += …</code></td></tr> <tr><td><code>… -= …</code></td></tr> <tr><td><code>… **= …</code></td></tr> <tr><td><code>… *= …</code></td></tr> <tr><td><code>… /= …</code></td></tr> <tr><td><code>… %= …</code></td></tr> <tr><td><code>… &lt;&lt;= …</code></td></tr> <tr><td><code>… &gt;&gt;= …</code></td></tr> <tr><td><code>… &gt;&gt;&gt;= …</code></td></tr> <tr><td><code>… &amp;= …</code></td></tr> <tr><td><code>… ^= …</code></td></tr> <tr><td><code>… |= …</code></td></tr> <tr><td rowspan="2">2</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/yield" title="The yield keyword is used to pause and resume a generator function (function* or legacy generator function)."><code>yield</code></a></td> <td colspan="1" rowspan="2">right-to-left</td> <td><code>yield …</code></td></tr> <tr><td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/yield*" title="The yield* expression is used to delegate to another generator or iterable object."><code>yield*</code></a></td> <td><code>yield* …</code></td></tr> <tr><td>1</td> <td><a href="/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator">Comma / Sequence</a></td> <td>left-to-right</td> <td><code>… , …</code></td></tr></tbody></table> <h2 id="plugins-插件"><a href="#plugins-插件" aria-hidden="true" class="header-anchor">#</a> plugins 插件</h2> <ul><li><a href="http://www.createjs.cc/preloadjs/docs/modules/PreloadJS.html" target="_blank" rel="noopener noreferrer">PreloadJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> PreloadJS是一个用来管理和协调相关资源加载的类库，它可以方便的帮助你预先加载相关资源。</li> <li><a href="http://www.createjs.cc/soundjs/docs/modules/SoundJS.html" target="_blank" rel="noopener noreferrer">SoundJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> SoundJS提供了简单而强大的API来处理音频。通过插件来执行实际的音频实现，简单直接的处理声音。</li> <li><a href="http://www.createjs.cc/easeljs/docs/modules/EaselJS.html" target="_blank" rel="noopener noreferrer">EaselJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一个JavaScript库,使HTML5 Canvas标签变得更简单。用于创建游戏，生成艺术作品，和处理其他高级图形化等有着很友好的体验。</li> <li><a href="http://www.createjs.cc/tweenjs/docs/modules/TweenJS.html" target="_blank" rel="noopener noreferrer">TweenJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> TweenJS类库主要用来调整和动画HTML5和Javascript属性，提供了简单并且强大的tweening接口。</li> <li><a href="https://github.com/jaweii/Vueg----page-transition-plugin" target="_blank" rel="noopener noreferrer">vueg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 为Vue应用添加页面间的转场特效(使用npm安装)</li> <li>dayjs 时间格式化</li> <li>weixin-js-sdk 微信SDK (使用cnpm安装)</li> <li><a href="http://mockjs.com/0.1/" target="_blank" rel="noopener noreferrer">mockjs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 模拟数据</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">9/30/2019, 1:39:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/yjm.github.io/notes/REACT/Taro.html" class="prev">taro组件构子</a></span> <span class="next"><a href="/yjm.github.io/notes/JS/JavaScript-1.html">JavaScript原理</a>→
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/yjm.github.io/assets/js/app.16d43aae.js" defer></script><script src="/yjm.github.io/assets/js/2.dc0e93a8.js" defer></script><script src="/yjm.github.io/assets/js/8.21d2d8cf.js" defer></script>
  </body>
</html>
